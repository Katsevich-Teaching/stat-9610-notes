<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STAT 9610 Lecture Notes - 15&nbsp; The bootstrap</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./permutation-test.html" rel="next">
<link href="./asymptotic-methods.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear-models-misspecification.html">Linear models: Misspecification</a></li><li class="breadcrumb-item"><a href="./bootstrap.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The bootstrap</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">STAT 9610 Lecture Notes</a> 
        <div class="sidebar-tools-main">
    <a href="./STAT-9610-Lecture-Notes.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./linear-models-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear models: Estimation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interpreting-linear-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Interpreting linear models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./least-squares-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Least squares estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analysis of variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./collinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Collinearity and adjustment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-demo-part-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R demo</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./linear-models-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear models: Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./building-blocks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Building blocks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Power</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confidence-intervals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Confidence intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./practical-considerations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Practical considerations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-demo-part-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">R demo</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./linear-models-misspecification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear models: Misspecification</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misspecification-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./asymptotic-methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Asymptotic methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The bootstrap</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./permutation-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">The permutation test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./robust-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Robust estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-demo-part-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">R demo</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./glm-general-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized linear models: General theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exponential-dispersion-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Exponential dispersion model (EDM) distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized-linear-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">GLM definition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parameter-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Parameter estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Inference in GLMs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-demo-part-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">R demo</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./glm-special-cases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized linear models: Special cases</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./poisson-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Poisson regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./negative-binomial-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Negative binomial regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-demo-part-5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">R demo</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./multiple-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-testing-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./global-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Global testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-testing-chapter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Multiple testing</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-the-bootstrap" id="toc-introduction-to-the-bootstrap" class="nav-link active" data-scroll-target="#introduction-to-the-bootstrap"><span class="header-section-number">15.1</span> Introduction to the bootstrap</a>
  <ul class="collapse">
  <li><a href="#usual-inference-paradigm" id="toc-usual-inference-paradigm" class="nav-link" data-scroll-target="#usual-inference-paradigm"><span class="header-section-number">15.1.1</span> Usual inference paradigm</a></li>
  <li><a href="#sec-bootstrap-inference-paradigm" id="toc-sec-bootstrap-inference-paradigm" class="nav-link" data-scroll-target="#sec-bootstrap-inference-paradigm"><span class="header-section-number">15.1.2</span> Bootstrap inference paradigm</a></li>
  <li><a href="#overview-of-bootstrap-flavors" id="toc-overview-of-bootstrap-flavors" class="nav-link" data-scroll-target="#overview-of-bootstrap-flavors"><span class="header-section-number">15.1.3</span> Overview of bootstrap flavors</a></li>
  </ul></li>
  <li><a href="#sec-derivative-quantities" id="toc-sec-derivative-quantities" class="nav-link" data-scroll-target="#sec-derivative-quantities"><span class="header-section-number">15.2</span> Derivative quantities on which to base inference</a>
  <ul class="collapse">
  <li><a href="#the-empirical-bootstrap" id="toc-the-empirical-bootstrap" class="nav-link" data-scroll-target="#the-empirical-bootstrap"><span class="header-section-number">15.2.1</span> The empirical bootstrap</a></li>
  <li><a href="#the-bootstrap-t-method" id="toc-the-bootstrap-t-method" class="nav-link" data-scroll-target="#the-bootstrap-t-method"><span class="header-section-number">15.2.2</span> The bootstrap-<span class="math inline">\(t\)</span> method</a></li>
  </ul></li>
  <li><a href="#sec-bootstrap-techniques" id="toc-sec-bootstrap-techniques" class="nav-link" data-scroll-target="#sec-bootstrap-techniques"><span class="header-section-number">15.3</span> Techniques for learning the data distribution</a>
  <ul class="collapse">
  <li><a href="#sec-parametric-bootstrap" id="toc-sec-parametric-bootstrap" class="nav-link" data-scroll-target="#sec-parametric-bootstrap"><span class="header-section-number">15.3.1</span> The parametric bootstrap</a></li>
  <li><a href="#sec-residual-bootstrap" id="toc-sec-residual-bootstrap" class="nav-link" data-scroll-target="#sec-residual-bootstrap"><span class="header-section-number">15.3.2</span> The residual bootstrap</a></li>
  <li><a href="#sec-pairs-bootstrap" id="toc-sec-pairs-bootstrap" class="nav-link" data-scroll-target="#sec-pairs-bootstrap"><span class="header-section-number">15.3.3</span> Pairs bootstrap</a></li>
  <li><a href="#sec-clustered-bootstrap" id="toc-sec-clustered-bootstrap" class="nav-link" data-scroll-target="#sec-clustered-bootstrap"><span class="header-section-number">15.3.4</span> Clustered bootstrap</a></li>
  <li><a href="#sec-moving-blocks-bootstrap" id="toc-sec-moving-blocks-bootstrap" class="nav-link" data-scroll-target="#sec-moving-blocks-bootstrap"><span class="header-section-number">15.3.5</span> Moving blocks bootstrap</a></li>
  </ul></li>
  <li><a href="#sec-bootstrap-hypothesis-testing" id="toc-sec-bootstrap-hypothesis-testing" class="nav-link" data-scroll-target="#sec-bootstrap-hypothesis-testing"><span class="header-section-number">15.4</span> Bootstrap hypothesis testing</a>
  <ul class="collapse">
  <li><a href="#sec-bootstrap-testing-paradigm" id="toc-sec-bootstrap-testing-paradigm" class="nav-link" data-scroll-target="#sec-bootstrap-testing-paradigm"><span class="header-section-number">15.4.1</span> Bootstrap testing paradigm</a></li>
  <li><a href="#testing-with-the-residual-bootstrap" id="toc-testing-with-the-residual-bootstrap" class="nav-link" data-scroll-target="#testing-with-the-residual-bootstrap"><span class="header-section-number">15.4.2</span> Testing with the residual bootstrap</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-bootstrap" class="quarto-section-identifier"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The bootstrap</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction-to-the-bootstrap" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="introduction-to-the-bootstrap"><span class="header-section-number">15.1</span> Introduction to the bootstrap</h2>
<p>The bootstrap can be used for either confidence interval construction or hypothesis testing, with confidence interval construction being a much more common application. For this reason, we will focus on confidence interval construction in remainder of this section as well as in <a href="#sec-derivative-quantities"><span>Section&nbsp;15.2</span></a> and <a href="#sec-bootstrap-techniques"><span>Section&nbsp;15.3</span></a>. We will discuss bootstrap hypothesis testing in <a href="#sec-bootstrap-hypothesis-testing"><span>Section&nbsp;15.4</span></a>.</p>
<section id="usual-inference-paradigm" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="usual-inference-paradigm"><span class="header-section-number">15.1.1</span> Usual inference paradigm</h3>
<p>We typically carry out linear model inference for <span class="math inline">\(\beta_j\)</span> by approximating the sampling distribution of <span class="math inline">\(\widehat\beta_j\)</span>, or a derivative thereof, such as the <span class="math inline">\(t\)</span>-statistic. Under the standard linear model assumptions, we have <span id="eq-asymptotic-1"><span class="math display">\[
g(\boldsymbol{\widehat \beta}, \boldsymbol \beta) \equiv \widehat{\beta}_j - \beta_j \sim N(0, \sigma^2 [(\boldsymbol{X}^T \boldsymbol{X})^{-1}]_{jj})
\tag{15.1}\]</span></span> and <span id="eq-asymptotic-2"><span class="math display">\[
g(\boldsymbol{\widehat \beta}, \boldsymbol \beta) \equiv \frac{\widehat{\beta}_j - \beta_j}{\text{s.e.}(\widehat \beta_j)} \sim t_{n-p}.
\tag{15.2}\]</span></span> Here, <span class="math inline">\(g(\boldsymbol{\widehat \beta}, \boldsymbol \beta)\)</span> denotes a derivative quantity, whose distribution is the basis for inference. If the lower and upper quantiles <span class="math inline">\(\mathbb Q_{\alpha/2}[g(\boldsymbol{\widehat \beta}, \boldsymbol \beta)]\)</span> and <span class="math inline">\(\mathbb Q_{1-\alpha/2}[g(\boldsymbol{\widehat \beta}, \boldsymbol \beta)]\)</span> are known, then we can construct a <span class="math inline">\((1-\alpha)\)</span> confidence interval for <span class="math inline">\(\beta_j\)</span> as <span id="eq-general-confidence-interval"><span class="math display">\[
\text{CI}(\beta_j) \equiv \{\beta_j: g(\boldsymbol{\widehat \beta}, \boldsymbol \beta) \in [\mathbb Q_{\alpha/2}[g(\boldsymbol{\widehat \beta}, \boldsymbol \beta)], \mathbb Q_{1-\alpha/2}[g(\boldsymbol{\widehat \beta}, \boldsymbol \beta)]]\}.
\tag{15.3}\]</span></span></p>
<p>Under model misspecification, the distributions on the right-hand sides of equations (<a href="#eq-asymptotic-1"><span>15.1</span></a>) and (<a href="#eq-asymptotic-2"><span>15.2</span></a>) may no longer be valid.</p>
</section>
<section id="sec-bootstrap-inference-paradigm" class="level3" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="sec-bootstrap-inference-paradigm"><span class="header-section-number">15.1.2</span> Bootstrap inference paradigm</h3>
<p>The <em>bootstrap</em> is an approach to more robust inference that obtains such sampling distributions by a technique known as <em>resampling</em>. The core idea of the bootstrap is to use the data to construct an approximation to the data-generating distribution and then to approximate the sampling distribution of any statistic by simulating from this approximate data-generating distribution. In more detail, the bootstrap paradigm is as follows:</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrap paradigm to build confidence intervals for <span class="math inline">\(\beta_j\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Use the data <span class="math inline">\((\boldsymbol X, \boldsymbol y)\)</span> to get an approximation <span class="math inline">\(\widehat F\)</span> for the data distribution <span class="math inline">\(F\)</span>.</li>
<li>For each <span class="math inline">\(b = 1, \dots, B\)</span>,
<ol type="i">
<li>Sample a bootstrap dataset <span class="math inline">\((\boldsymbol X^{(b)}, \boldsymbol y^{(b)}) \sim \widehat F\)</span>;</li>
<li>Fit the least squares estimate <span class="math inline">\(\boldsymbol{\widehat \beta}^{(b)}\)</span> based on <span class="math inline">\((\boldsymbol X^{(b)}, \boldsymbol y^{(b)})\)</span>;</li>
<li>Construct a derivative quantity <span class="math inline">\(g(\boldsymbol{\widehat \beta}^{(b)}, \boldsymbol{\widehat \beta})\)</span>, such as <span class="math inline">\(\widehat \beta^{(b)}_j - \widehat \beta_j\)</span>.</li>
</ol></li>
<li>Extract the empirical <span class="math inline">\(\alpha/2\)</span> and <span class="math inline">\(1-\alpha/2\)</span> quantiles of the derivative quantity <span class="math inline">\(g(\boldsymbol{\widehat \beta}^{(b)}, \boldsymbol{\widehat \beta})\)</span>, denoted <span class="math inline">\(\mathbb Q_{\alpha/2}[g(\boldsymbol{\widehat \beta}^{(b)}, \boldsymbol{\widehat \beta})]\)</span> and <span class="math inline">\(\mathbb Q_{1-\alpha/2}[g(\boldsymbol{\widehat \beta}^{(b)}, \boldsymbol{\widehat \beta})]\)</span>.</li>
<li>Construct a <span class="math inline">\((1-\alpha)\)</span> confidence interval for <span class="math inline">\(\beta_j\)</span> by analogy with (<a href="#eq-general-confidence-interval"><span>15.3</span></a>): <span id="eq-bootstrap-confidence-interval"><span class="math display">\[
\begin{split}
&amp;\text{CI}^{\text{boot}}(\beta_j) \\
&amp;\quad \equiv \{\beta_j: g(\boldsymbol{\widehat \beta}, \boldsymbol \beta) \in [\mathbb Q_{\alpha/2}[g(\boldsymbol{\widehat \beta}^{(b)}, \boldsymbol{\widehat \beta})], \mathbb Q_{1-\alpha/2}[g(\boldsymbol{\widehat \beta}^{(b)}, \boldsymbol{\widehat \beta})]]\}.
\end{split}
\tag{15.4}\]</span></span></li>
</ol>
</div>
</div>
<p>This approach, pioneered by Brad Efron in 1979, obviates the need for stringent assumptions and mathematical derivations to obtain limiting distributions, replacing these with added computation. The bootstrap is extremely flexible and can be adapted to apply in a variety of settings. Furthermore, bootstrap methods are typically more accurate than their asymptotic counterparts in finite samples. While the justification of the bootstrap is still asymptotic (requiring <span class="math inline">\(\widehat F\)</span> to approach <span class="math inline">\(F\)</span>), the rate of convergence is often “second-order” <span class="math inline">\(O(1/n)\)</span> rather than the usual “first-order” <span class="math inline">\(O(1/\sqrt{n})\)</span> of standard asymptotic inference. This faster second-order convergence gives the bootstrap an advantage in finite samples.</p>
</section>
<section id="overview-of-bootstrap-flavors" class="level3" data-number="15.1.3">
<h3 data-number="15.1.3" class="anchored" data-anchor-id="overview-of-bootstrap-flavors"><span class="header-section-number">15.1.3</span> Overview of bootstrap flavors</h3>
<p>The bootstrap comes in a variety of flavors, dictated by the mechanism by which the data distribution <span class="math inline">\(F\)</span> is learned (e.g.&nbsp;the <em>parametric</em>, <em>residual</em>, or <em>pairs</em> bootstraps), and the derivative quantity <span class="math inline">\(g(\cdot, \cdot)\)</span> on which inference is based (e.g.&nbsp;the <em>empirical bootstrap</em> and the <em>bootstrap-<span class="math inline">\(t\)</span></em>). These two sets of flavors can be mixed and matched.</p>
</section>
</section>
<section id="sec-derivative-quantities" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="sec-derivative-quantities"><span class="header-section-number">15.2</span> Derivative quantities on which to base inference</h2>
<section id="the-empirical-bootstrap" class="level3" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="the-empirical-bootstrap"><span class="header-section-number">15.2.1</span> The empirical bootstrap</h3>
<p>The <em>empirical bootstrap</em>, the most common choice, is based on the quantity <span class="math display">\[
g(\boldsymbol{\widehat \beta}, \boldsymbol{\beta}) = \widehat \beta_j- \beta_j,
\]</span> We can derive that if <span class="math display">\[
\mathbb P\left[\widehat \beta_j - \beta_j \in \left[\mathbb Q_{\alpha/2}[\widehat \beta^{(b)}_j - \widehat \beta_j], \mathbb Q_{1-\alpha/2}[\widehat \beta^{(b)}_j - \widehat \beta_j]\right]\right] \overset \cdot \geq 1-\alpha,
\]</span> then <span class="math display">\[
\mathbb P\left[\beta_j \in \left[\widehat \beta_j - \mathbb Q_{1-\alpha/2}[\widehat \beta^{(b)}_j - \widehat \beta_j], \widehat \beta_j - \mathbb Q_{\alpha/2}[\widehat \beta^{(b)}_j - \widehat \beta_j]\right]\right] \overset \cdot \geq 1-\alpha.
\]</span> For this reason, we define <span class="math display">\[
\text{CI}^{\text{boot}}(\beta_j) \equiv \left[\widehat \beta_j - \mathbb Q_{1-\alpha/2}[\widehat \beta^{(b)}_j - \widehat \beta_j], \widehat \beta_j - \mathbb Q_{\alpha/2}[\widehat \beta^{(b)}_j - \widehat \beta_j]\right].
\]</span></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The percentile bootstrap
</div>
</div>
<div class="callout-body-container callout-body">
<p>A commonly used alternative to the empirical bootstrap is the <em>percentile bootstrap</em>, defined by <span id="eq-percentile-bootstrap"><span class="math display">\[
\text{CI}^{\text{boot}}(\beta_j) \equiv \left[\mathbb Q_{\alpha/2}[\widehat \beta^{(b)}_j], \mathbb Q_{1-\alpha/2}[\widehat \beta^{(b)}_j]\right].
\tag{15.5}\]</span></span> Here, the resampling distribution of <span class="math inline">\(\widehat \beta_j\)</span> is used directly to construct the confidence interval. However, this approach does not fall within the bootstrap paradigm described above, and in particular, the formula (<a href="#eq-percentile-bootstrap"><span>15.5</span></a>) is not a special case of (<a href="#eq-bootstrap-confidence-interval"><span>15.4</span></a>). The formula (<a href="#eq-percentile-bootstrap"><span>15.5</span></a>) can be viewed as seeking an interval within which <span class="math inline">\(\widehat \beta_j\)</span> (rather than <span class="math inline">\(\beta_j\)</span> itself) falls with 95% probability. The percentile bootstrap is only justified when the distribution of <span class="math inline">\(\widehat \beta^{(b)}_j\)</span> is symmetric about <span class="math inline">\(\widehat \beta_j\)</span>, in which case it coincides with the empirical bootstrap.</p>
</div>
</div>
</section>
<section id="the-bootstrap-t-method" class="level3" data-number="15.2.2">
<h3 data-number="15.2.2" class="anchored" data-anchor-id="the-bootstrap-t-method"><span class="header-section-number">15.2.2</span> The bootstrap-<span class="math inline">\(t\)</span> method</h3>
<p>A weakness of the empirical bootstrap is that the quantity <span class="math inline">\(g(\boldsymbol{\widehat \beta}, \boldsymbol{\beta}) = \widehat \beta_j - \beta_j\)</span> has distribution <span class="math inline">\(N(0, \sigma^2 [(X^T X)^{-1}]_{jj})\)</span> (recalling equation (<a href="#eq-asymptotic-1"><span>15.1</span></a>)), <em>which depends on the nuisance parameter <span class="math inline">\(\sigma^2\)</span>.</em> When we approximate this distribution by bootstrapping, we implicitly are substituting in an estimate of <span class="math inline">\(\sigma^2\)</span>, which is itself subject to sampling variability. The empirical bootstrap does not account for this variability, because the distribution <span class="math inline">\(\widehat F\)</span> on which the estimate of <span class="math inline">\(\sigma^2\)</span> is based is held fixed throughout. To see this more clearly, consider the following example.</p>
<div id="exm-non-pivotal" class="theorem example">
<p><span class="theorem-title"><strong>Example 15.1 (Non-pivotality in the normal mean problem) </strong></span>Suppose that <span class="math inline">\(\boldsymbol y \sim N(\boldsymbol 1 \beta_0, \sigma^2 \boldsymbol I)\)</span>, and the goal is to construct a confidence interval for <span class="math inline">\(\beta_0\)</span>. Defining <span class="math inline">\(\widehat \beta_0 \equiv \bar y\)</span> and <span class="math inline">\(\widehat \sigma^2 \equiv \tfrac 1 {n-1} \sum_{i=1}^n (y_i - \bar y)^2\)</span>, consider the empirical bootstrap based on resampling <span class="math inline">\(\boldsymbol y^{(b)} \sim N(\boldsymbol 1 \widehat \beta_0, \widehat \sigma^2 \boldsymbol I)\)</span>. In this case, we will find that <span class="math display">\[
\widehat \beta^{(b)}_0 - \widehat \beta_0 = \bar y^{(b)} - \bar y \sim N(0, \widehat \sigma^2/n),
\]</span> which will give rise to the bootstrap confidence interval <span class="math display">\[
\text{CI}^{\text{boot}}(\beta_0) = \widehat \beta_0 \pm z_{1-\alpha/2} \tfrac{1}{\sqrt{n}} \widehat \sigma.
\]</span> The uncertainty in the estimate <span class="math inline">\(\widehat \sigma^2\)</span> is not accounted for. We know from Unit 2 that, if the usual linear model assumptions are satisfied, we could account for this uncertainty by using a <span class="math inline">\(t\)</span>-distribution instead of a normal distribution.</p>
</div>
<p>This issue can be addressed by bootstrapping a <em>pivotal</em> quantity <span class="math inline">\(g(\boldsymbol{\widehat \beta}, \boldsymbol{\beta})\)</span>, i.e., a quantity whose distribution does not depend on unknown parameters (at least under standard assumptions). In the context of the linear model, the <span class="math inline">\(t\)</span>-statistic (<a href="#eq-asymptotic-2"><span>15.2</span></a>) is pivotal. Bootstrapping the <span class="math inline">\(t\)</span>-statistic, called the <em>bootstrap-<span class="math inline">\(t\)</span> method</em>, is therefore a way to account for the uncertainty in the estimate of <span class="math inline">\(\sigma^2\)</span>. To derive the bootstrap-<span class="math inline">\(t\)</span> method, we approximate <span class="math display">\[
\mathbb{P} \left[ \frac{\widehat{\beta}_j - \beta_j}{\text{s.e.}(\widehat{\beta}_j)} \in \left[ \mathbb{Q}_{\alpha/2} \left( \frac{\widehat{\beta}_j^{(b)} - \widehat{\beta}_j}{\text{s.e.}(\widehat{\beta}_j^{(b)})} \right), \mathbb{Q}_{1-\alpha/2} \left( \frac{\widehat{\beta}_j^{(b)} - \widehat{\beta}_j}{\text{s.e.}(\widehat{\beta}_j^{(b)})} \right) \right] \right] \overset{\cdot}{\geq} 1-\alpha,
\]</span> which justifies the bootstrap-<span class="math inline">\(t\)</span> confidence interval <span class="math display">\[
\begin{split}
&amp;\text{CI}^{\text{boot}}(\beta_j) \\
&amp;\quad \equiv \left[\widehat \beta_j - \text{s.e.}(\widehat \beta_j) \mathbb Q_{1-\alpha/2} \left( \frac{\widehat \beta_j^{(b)} - \widehat \beta_j}{\text{s.e.}(\widehat \beta_j^{(b)})} \right), \widehat \beta_j - \text{s.e.}(\widehat \beta_j) \mathbb Q_{\alpha/2} \left( \frac{\widehat \beta_j^{(b)} - \widehat \beta_j}{\text{s.e.}(\widehat \beta_j^{(b)})} \right)\right].
\end{split}
\]</span></p>
</section>
</section>
<section id="sec-bootstrap-techniques" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="sec-bootstrap-techniques"><span class="header-section-number">15.3</span> Techniques for learning the data distribution</h2>
<p>The methods for learning the data distribution lie on a spectrum based on how flexibly they model this distribution. Methods with less flexibility are more stable (i.e.&nbsp;less variable) but less robust. On the other hand, methods with more flexibility are more robust but less stable. The following table shows the methods in increasing order of flexibility, including which types of model misspecification they are robust to.</p>
<div style="text-align: center;">
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 14%">
<col style="width: 20%">
<col style="width: 18%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Non-normality</th>
<th>Hetero-skedasticity</th>
<th>Group correlation</th>
<th>Temporal correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Parametric</td>
<td>✘</td>
<td>✘</td>
<td>✘</td>
<td>✘</td>
</tr>
<tr class="even">
<td>Residual</td>
<td>✔</td>
<td>✘</td>
<td>✘</td>
<td>✘</td>
</tr>
<tr class="odd">
<td>Pairs</td>
<td>✔</td>
<td>✔</td>
<td>✘</td>
<td>✘</td>
</tr>
<tr class="even">
<td>Clustered</td>
<td>✔</td>
<td>✔</td>
<td>✔</td>
<td>✘</td>
</tr>
<tr class="odd">
<td>Moving Blocks</td>
<td>✔</td>
<td>✔</td>
<td>✘</td>
<td>✔</td>
</tr>
</tbody>
</table>
</div>
<p>We will present these methods in the same order, starting from the parametric bootstrap.</p>
<section id="sec-parametric-bootstrap" class="level3" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="sec-parametric-bootstrap"><span class="header-section-number">15.3.1</span> The parametric bootstrap</h3>
<p>The parametric bootstrap proceeds by specifying a parametric model for the data <span class="math inline">\((\boldsymbol X, \boldsymbol y)\)</span>, such as the one from Unit 2: <span id="eq-standard-parametric-form"><span class="math display">\[
\boldsymbol y = \boldsymbol X \boldsymbol \beta + \boldsymbol \epsilon, \quad \boldsymbol \epsilon \sim N(0, \sigma^2 \boldsymbol I).
\tag{15.6}\]</span></span> The model matrix <span class="math inline">\(\boldsymbol X\)</span> is kept fixed and only the distribution of <span class="math inline">\(\boldsymbol y\)</span> (conditionally on <span class="math inline">\(\boldsymbol X\)</span>) is modeled. These parameters can be fit by maximum likelihood, as usual. Then, the bootstrapped datasets can be generated as follows: <span class="math display">\[
\boldsymbol X^{(b)} = \boldsymbol X; \quad \boldsymbol y^{(b)} \sim N(\boldsymbol X \boldsymbol{\widehat \beta}, \widehat \sigma^2 \boldsymbol I).
\]</span> In the context of the linear model, the parametric bootstrap is rarely used, particularly in the context of the standard parametric form (<a href="#eq-standard-parametric-form"><span>15.6</span></a>) and the least squares estimator <span class="math inline">\(\boldsymbol{\widehat \beta}\)</span>. Indeed, it offers no robustness to model misspecification and the distribution of the least squares estimator is known exactly, so there is no need to approximate it using resampling. In contexts beyond linear models or when estimators beyond the least squares estimator are of interest, the parametric bootstrap is useful because it can be used the approximate the distributions of analytically intractable estimators, substituting computation for math.</p>
</section>
<section id="sec-residual-bootstrap" class="level3" data-number="15.3.2">
<h3 data-number="15.3.2" class="anchored" data-anchor-id="sec-residual-bootstrap"><span class="header-section-number">15.3.2</span> The residual bootstrap</h3>
<p>The residual bootstrap is based on a <em>parametric</em> model for <span class="math inline">\(\mathbb E[\boldsymbol y \mid \boldsymbol X]\)</span> and a <em>nonparametric</em> model for the noise terms. In particular, suppose that <span id="eq-residual-bootstrap"><span class="math display">\[
y_i = \boldsymbol x_{i*}^T \boldsymbol \beta + \epsilon_i, \quad \epsilon_i \overset{\text{i.i.d.}}{\sim} G \quad \text{for } i = 1, \dots, n,
\tag{15.7}\]</span></span> where <span class="math inline">\(G\)</span> is an unknown distribution without a parametric form. Then, the data-generating distribution <span class="math inline">\(F\)</span> is specified by the pair <span class="math inline">\((\boldsymbol \beta, G)\)</span>. As with the parametric bootstrap, the model matrix <span class="math inline">\(\boldsymbol X\)</span> is kept fixed and only the distribution of <span class="math inline">\(\boldsymbol y\)</span> (conditionally on <span class="math inline">\(\boldsymbol X\)</span>) is modeled. The parameter vector <span class="math inline">\(\boldsymbol \beta\)</span> can be fit by least squares, as usual. Then, the distribution of the noise terms <span class="math inline">\(\epsilon_i\)</span> can be estimated by the empirical distribution of the residuals <span class="math inline">\(\widehat \epsilon_i\)</span>: <span class="math display">\[
\widehat G = \frac{1}{n} \sum_{i=1}^n \delta_{\widehat \epsilon_i},
\]</span> where <span class="math inline">\(\delta_{\widehat \epsilon_i}\)</span> is the Dirac delta function at <span class="math inline">\(\widehat \epsilon_i\)</span>. The bootstrapped datasets can then be generated as follows: <span class="math display">\[
x_{i*}^{(b)} = x_{i*}; \quad y_i^{(b)} = \boldsymbol x_{i*}^T \boldsymbol{\widehat \beta} + \epsilon_i^{(b)}, \quad \epsilon_i^{(b)} \overset{\text{i.i.d.}}{\sim} \widehat G \quad \text{for } i = 1, \dots, n.
\]</span> Note that the sampling of <span class="math inline">\(\epsilon_i^{(b)} \overset{\text{i.i.d.}}{\sim} \widehat G\)</span> is equivalent to sampling with replacement from the residuals <span class="math inline">\(\widehat \epsilon_i\)</span>. By avoiding modeling <span class="math inline">\(\epsilon_i\)</span> as normal, the residual bootstrap is robust to non-normality. However, it is not robust to heteroskedasticity or correlated errors, because it models the <span class="math inline">\(\epsilon_i\)</span> as i.i.d. from some distribution.</p>
</section>
<section id="sec-pairs-bootstrap" class="level3" data-number="15.3.3">
<h3 data-number="15.3.3" class="anchored" data-anchor-id="sec-pairs-bootstrap"><span class="header-section-number">15.3.3</span> Pairs bootstrap</h3>
<p>Weakening the assumptions further, let us assume simply that <span class="math display">\[
(\boldsymbol{x}_{i*}, y_i) \overset{\text{i.i.d.}}{\sim} F
\]</span> for some joint distribution <span class="math inline">\(F\)</span>. Unlike the parametric and residual bootstraps, the pairs bootstrap treats the predictors <span class="math inline">\(\boldsymbol X\)</span> as random rather than fixed. We can then fit <span class="math inline">\(\widehat F\)</span> as the empirical distribution of the data: <span class="math display">\[
\widehat F = \frac{1}{n} \sum_{i=1}^n \delta_{(\boldsymbol{x}_{i*}, y_i)}.
\]</span> The bootstrapped datasets can then be generated as follows: <span class="math display">\[
(\boldsymbol{x}_{i*}^{(b)}, y_i^{(b)}) \overset{\text{i.i.d.}}{\sim} \widehat F \quad \text{for } i = 1, \dots, n.
\]</span> Note that sampling the pairs <span class="math inline">\((\boldsymbol{x}_{i*}^{(b)}, y_i^{(b)})\)</span> from <span class="math inline">\(\widehat F\)</span> is equivalent to sampling with replacement from the rows of the original data. The benefit of the pairs bootstrap is that it does not assume homoskedasticity since the error variance is allowed to depend on <span class="math inline">\(\boldsymbol{x}_{i*}\)</span>. Therefore, the pairs bootstrap addresses both non-normality and heteroskedasticity, though it does not address correlated errors (though variants of the pairs bootstrap do; see below). Note that the pairs bootstrap does not even assume that <span class="math inline">\(\mathbb{E}[y_i] = \boldsymbol{x}_{i*}^T \boldsymbol{\beta}\)</span> for some <span class="math inline">\(\boldsymbol{\beta}\)</span>. However, in the presence of model bias, it is unclear for what parameters we are even doing inference. While the pairs bootstrap assumes less than the residual bootstrap, it may be somewhat less efficient in the case when the assumptions of the latter are met. However, the pairs bootstrap is the most commonly applied flavor of the bootstrap.</p>
</section>
<section id="sec-clustered-bootstrap" class="level3" data-number="15.3.4">
<h3 data-number="15.3.4" class="anchored" data-anchor-id="sec-clustered-bootstrap"><span class="header-section-number">15.3.4</span> Clustered bootstrap</h3>
<p>In the presence of clustered errors, the pairs bootstrap can be modified to the <em>clustered bootstrap</em>. The distributional assumption underlying the clustered bootstrap is the following: <span id="eq-clustered-bootstrap"><span class="math display">\[
\{(\boldsymbol{x}_{i*}, y_i): c(i) = c\} \overset{\text{i.i.d.}}{\sim} F \quad \text{for } c = 1, \dots, C,
\tag{15.8}\]</span></span> where <span class="math inline">\(c(i)\)</span> is the cluster to which observation <span class="math inline">\(i\)</span> belongs. Therefore, entire clusters are modeled as coming i.i.d. from some distribution across clusters. As with the pairs bootstrap, this distribution is estimated by the empirical distribution of the data, and resampling from this distribution amounts to <em>sampling entire clusters</em> (rather than individual observations) from the original data, with replacement. This kind of resampling preserves the joint correlation structure within clusters. Note that the clustered bootstrap is a special case of the pairs bootstrap, where each pair forms its own cluster.</p>
</section>
<section id="sec-moving-blocks-bootstrap" class="level3" data-number="15.3.5">
<h3 data-number="15.3.5" class="anchored" data-anchor-id="sec-moving-blocks-bootstrap"><span class="header-section-number">15.3.5</span> Moving blocks bootstrap</h3>
<p>In the case of temporally (or spatially) correlated errors, the pairs bootstrap can be modified to the <em>moving blocks bootstrap</em>. The distributional assumption underlying the moving blocks bootstrap is the same as that of the clustered bootstrap (<a href="#eq-clustered-bootstrap"><span>15.8</span></a>), except the clusters are defined as contiguous blocks of observations. The distribution across blocks is fit as the empirical distribution of all blocks of a given size, and resampling from this distribution amounts to <em>sampling entire blocks</em> (rather than individual observations) from the original data, with replacement. This kind of resampling preserves the joint correlation structure within temporal or spatial blocks, though it ignores correlations across boundaries of these blocks. Like the clustered bootstrap, the moving blocks bootstrap is a special case of the pairs bootstrap.</p>
</section>
</section>
<section id="sec-bootstrap-hypothesis-testing" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="sec-bootstrap-hypothesis-testing"><span class="header-section-number">15.4</span> Bootstrap hypothesis testing</h2>
<p>The bootstrap inference paradigm described in <a href="#sec-bootstrap-inference-paradigm"><span>Section&nbsp;15.1.2</span></a> is primarily for constructing confidence intervals. For one-dimensional quantities like <span class="math inline">\(\beta_j\)</span>, confidence intervals can be used to perform hypothesis tests via duality. However, it is more challenging to use the bootstrap to create confidence regions for multi-dimensional quantities like <span class="math inline">\(\boldsymbol{\beta}_S\)</span>. Nevertheless, in some cases the bootstrap paradigm can be adapted to perform hypothesis tests directly.</p>
<section id="sec-bootstrap-testing-paradigm" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="sec-bootstrap-testing-paradigm"><span class="header-section-number">15.4.1</span> Bootstrap testing paradigm</h3>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bootstrap paradigm to test <span class="math inline">\(H_0: \boldsymbol \beta_S = 0\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Compute a test statistic <span class="math inline">\(T(\boldsymbol X, \boldsymbol y)\)</span> measuring the evidence against <span class="math inline">\(H_0\)</span>.</li>
<li>Use the data <span class="math inline">\((\boldsymbol X, \boldsymbol y)\)</span> to get an approximation <span class="math inline">\(\widehat F\)</span> for the data distribution <span class="math inline">\(F\)</span>.</li>
<li>Find a null data distribution <span class="math inline">\(\widehat F_0\)</span> by “projecting” <span class="math inline">\(\widehat F\)</span> onto <span class="math inline">\(H_0\)</span>.</li>
<li>For each <span class="math inline">\(b = 1, \dots, B\)</span>,
<ol type="i">
<li>Sample a null bootstrap dataset <span class="math inline">\((\boldsymbol X^{(b)}, \boldsymbol y^{(b)}) \sim \widehat F_0\)</span>;</li>
<li>Evaluate the test statistic on the resampled data to get <span class="math inline">\(T(\boldsymbol X^{(b)}, \boldsymbol y^{(b)})\)</span>.</li>
</ol></li>
<li>Evaluate the empirical quantile <span class="math inline">\(\mathbb Q_{1-\alpha}(\{T(\boldsymbol X^{(b)}, \boldsymbol y^{(b)})\}_{b = 1}^B)\)</span>.</li>
<li>Reject if <span class="math inline">\(T(\boldsymbol X, \boldsymbol y) &gt; \mathbb Q_{1-\alpha}(\{T(\boldsymbol X^{(b)}, \boldsymbol y^{(b)})\}_{b = 1}^B)\)</span>.</li>
</ol>
</div>
</div>
<p>Here, the key new step is the third, in which a null data distribution <span class="math inline">\(\widehat F_0\)</span> is derived from the approximate data distribution <span class="math inline">\(\widehat F\)</span>. The challenge is that, depending on the form of <span class="math inline">\(\widehat F\)</span>, this may or may not be possible. In fact, obtaining <span class="math inline">\(\widehat F_0\)</span> from <span class="math inline">\(\widehat F\)</span> is easily done whenever the model for the data involves a parameter vector <span class="math inline">\(\boldsymbol \beta\)</span>, as is the case for the parametric and residual bootstraps (see the next section for more detail on the latter). In this case, <span class="math inline">\(\widehat F_0\)</span> can be obtained from <span class="math inline">\(\widehat F\)</span> by setting the coefficients <span class="math inline">\(\boldsymbol \beta_S\)</span> to zero. On the other hand, for the pairs bootstrap and its variants, it is not clear how to obtain <span class="math inline">\(\widehat F_0\)</span> from <span class="math inline">\(\widehat F\)</span>. Finally, note that the bootstrap testing paradigm is in principle compatible with any test statistic <span class="math inline">\(T\)</span>. A popular choice for <span class="math inline">\(T\)</span> is the <span class="math inline">\(F\)</span>-statistic for <span class="math inline">\(H_0: \boldsymbol \beta_S = 0\)</span> from Unit 2.</p>
</section>
<section id="testing-with-the-residual-bootstrap" class="level3" data-number="15.4.2">
<h3 data-number="15.4.2" class="anchored" data-anchor-id="testing-with-the-residual-bootstrap"><span class="header-section-number">15.4.2</span> Testing with the residual bootstrap</h3>
<p>A commonly used bootstrap flavor for hypothesis testing is the <em>residual bootstrap</em>. Recalling the data-generating model (<a href="#eq-residual-bootstrap"><span>15.7</span></a>), suppose <span class="math inline">\(\widehat F = (\boldsymbol{\widehat \beta}, \widehat G)\)</span> is the fitted model. Then, we can define <span class="math inline">\(\widehat F_0 = ((\boldsymbol 0, \boldsymbol{\widehat \beta}_{\text{-}S}), \widehat G)\)</span>. Therefore, the bootstrapped null data are drawn from the following distribution: <span class="math display">\[
x_{i*}^{(b)} = x_{i*}; \quad y_i^{(b)} = \boldsymbol x_{i, \text{-}S}^T \boldsymbol{\widehat \beta}_{\text{-}S} + \epsilon_i^{(b)}, \quad \epsilon_i^{(b)} \overset{\text{i.i.d.}}\sim \widehat G.
\]</span> As before, the bootstrapped residuals <span class="math inline">\(\epsilon_i^{(b)}\)</span> are sampled with replacement from the set of original residuals.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./asymptotic-methods.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Asymptotic methods</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./permutation-test.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">The permutation test</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>